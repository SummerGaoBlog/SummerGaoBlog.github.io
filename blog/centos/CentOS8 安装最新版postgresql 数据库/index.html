<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>解决Linux buffer cache内存占用过高的办法 | SummerGao Blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/favicon.ico">
    <script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.js"></script>
    <link rel="stylesheet" href="/style/style.css">
    <meta name="description" content="勤学●敏思●笃行">
    
    <link rel="preload" href="/assets/css/0.styles.a3d787d5.css" as="style"><link rel="preload" href="/assets/js/app.5d31ca31.js" as="script"><link rel="preload" href="/assets/js/3.aeb3bb78.js" as="script"><link rel="preload" href="/assets/js/33.f8ed6a7c.js" as="script"><link rel="prefetch" href="/assets/js/10.e286d7b3.js"><link rel="prefetch" href="/assets/js/11.fb7f7268.js"><link rel="prefetch" href="/assets/js/12.6efef0fa.js"><link rel="prefetch" href="/assets/js/13.360db8e4.js"><link rel="prefetch" href="/assets/js/14.e1d5fa79.js"><link rel="prefetch" href="/assets/js/15.f0d83995.js"><link rel="prefetch" href="/assets/js/16.64d063c6.js"><link rel="prefetch" href="/assets/js/17.e71c139e.js"><link rel="prefetch" href="/assets/js/18.ef48e58e.js"><link rel="prefetch" href="/assets/js/19.c3851ffb.js"><link rel="prefetch" href="/assets/js/2.170ec496.js"><link rel="prefetch" href="/assets/js/20.a3d8568d.js"><link rel="prefetch" href="/assets/js/21.5d7ee3d4.js"><link rel="prefetch" href="/assets/js/22.148bce14.js"><link rel="prefetch" href="/assets/js/23.ffba0a65.js"><link rel="prefetch" href="/assets/js/24.3c2e574f.js"><link rel="prefetch" href="/assets/js/25.188ae1e7.js"><link rel="prefetch" href="/assets/js/26.e5409532.js"><link rel="prefetch" href="/assets/js/27.569a5d7d.js"><link rel="prefetch" href="/assets/js/28.abac09cf.js"><link rel="prefetch" href="/assets/js/29.1db342f4.js"><link rel="prefetch" href="/assets/js/30.0f8755d0.js"><link rel="prefetch" href="/assets/js/31.92a111f2.js"><link rel="prefetch" href="/assets/js/32.5ceee6be.js"><link rel="prefetch" href="/assets/js/34.32ab9d52.js"><link rel="prefetch" href="/assets/js/35.e7e902f4.js"><link rel="prefetch" href="/assets/js/36.3a26d9e3.js"><link rel="prefetch" href="/assets/js/37.de11e5dc.js"><link rel="prefetch" href="/assets/js/38.f13e826e.js"><link rel="prefetch" href="/assets/js/39.d8249ccd.js"><link rel="prefetch" href="/assets/js/4.1f939c38.js"><link rel="prefetch" href="/assets/js/40.a67411eb.js"><link rel="prefetch" href="/assets/js/41.75438993.js"><link rel="prefetch" href="/assets/js/42.f6bb890d.js"><link rel="prefetch" href="/assets/js/43.3409fab0.js"><link rel="prefetch" href="/assets/js/44.3d7f2c15.js"><link rel="prefetch" href="/assets/js/45.82c29302.js"><link rel="prefetch" href="/assets/js/46.ab81a868.js"><link rel="prefetch" href="/assets/js/47.e2955b0e.js"><link rel="prefetch" href="/assets/js/48.b5da0d90.js"><link rel="prefetch" href="/assets/js/49.5681ea48.js"><link rel="prefetch" href="/assets/js/5.31a70226.js"><link rel="prefetch" href="/assets/js/6.4f3d3783.js"><link rel="prefetch" href="/assets/js/7.97139827.js"><link rel="prefetch" href="/assets/js/8.655e4813.js"><link rel="prefetch" href="/assets/js/9.a3375639.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a3d787d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">SummerGao Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/markdown/" class="nav-link">
  《Markdown Guide》
</a></li><li class="dropdown-item"><!----> <a href="/guide/chicagoboss/tutorial/" class="nav-link">
  《Chicago Boss: A Rough Introduction》
</a></li><li class="dropdown-item"><!----> <a href="/guide/cowboy/2.6/" class="nav-link">
  《Cowboy 2.6 User Guide》
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="图书" class="dropdown-title"><span class="title">图书</span> <span class="arrow down"></span></button> <button type="button" aria-label="图书" class="mobile-dropdown-title"><span class="title">图书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/books/blockchain/精通以太坊——实现数字合约/" class="nav-link">
  《精通以太坊——实现数字合约》
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/centos/" class="nav-link router-link-active">
  CentOS
</a></li><li class="dropdown-item"><!----> <a href="/blog/erlang/" class="nav-link">
  Erlang
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/blog/quotes/" class="nav-link">
  Quotes
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/" class="nav-link">
  Tools
</a></li></ul></div></div><div class="nav-item"><a href="/bigFrontEnd/" class="nav-link">
  大前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择语言" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  English
</a></li></ul></div></div><div class="nav-item"><a href="http://www.summergao.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/SummerGaoBlog/summergao-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/markdown/" class="nav-link">
  《Markdown Guide》
</a></li><li class="dropdown-item"><!----> <a href="/guide/chicagoboss/tutorial/" class="nav-link">
  《Chicago Boss: A Rough Introduction》
</a></li><li class="dropdown-item"><!----> <a href="/guide/cowboy/2.6/" class="nav-link">
  《Cowboy 2.6 User Guide》
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="图书" class="dropdown-title"><span class="title">图书</span> <span class="arrow down"></span></button> <button type="button" aria-label="图书" class="mobile-dropdown-title"><span class="title">图书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/books/blockchain/精通以太坊——实现数字合约/" class="nav-link">
  《精通以太坊——实现数字合约》
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/centos/" class="nav-link router-link-active">
  CentOS
</a></li><li class="dropdown-item"><!----> <a href="/blog/erlang/" class="nav-link">
  Erlang
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/blog/quotes/" class="nav-link">
  Quotes
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/" class="nav-link">
  Tools
</a></li></ul></div></div><div class="nav-item"><a href="/bigFrontEnd/" class="nav-link">
  大前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择语言" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  English
</a></li></ul></div></div><div class="nav-item"><a href="http://www.summergao.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/SummerGaoBlog/summergao-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CentOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/centos/%E8%A7%A3%E5%86%B3Linux%20buffer%20cache%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E7%9A%84%E5%8A%9E%E6%B3%95/" class="sidebar-link">解决Linux buffer/cache内存占用过高的办法</a></li><li><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/" aria-current="page" class="active sidebar-link">解决Linux buffer cache内存占用过高的办法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_1-先查看postgresql源" class="sidebar-link">1. 先查看postgresql源</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_2-安装" class="sidebar-link">2. 安装</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_3-初始化数据库" class="sidebar-link">3. 初始化数据库</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_4-启动postgresql服务-并配置为其能够在系统启动时启动" class="sidebar-link">4. 启动PostgreSQL服务，并配置为其能够在系统启动时启动</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_5-使用该psql工具通过连接到postgresql数据库服务器来验证安装并打印其版本" class="sidebar-link">5. 使用该psql工具通过连接到PostgreSQL数据库服务器来验证安装并打印其版本</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_6-postgresql角色和验证方法" class="sidebar-link">6. PostgreSQL角色和验证方法</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_7-创建postgresql角色和数据库" class="sidebar-link">7.创建PostgreSQL角色和数据库</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#https-oscimg-oschina-net-oscnet-up-294e3eae062a78c528749953f64ab638217-png" class="sidebar-link">![](https://oscimg.oschina.net/oscnet/up-294e3eae062a78c528749953f64ab638217.png)</a></li><li class="sidebar-sub-header"><a href="/blog/centos/CentOS8%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88postgresql%20%E6%95%B0%E6%8D%AE%E5%BA%93/#_8-启用对postgresql服务器的远程访问" class="sidebar-link">8. 启用对PostgreSQL服务器的远程访问</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="解决linux-buffer-cache内存占用过高的办法"><a href="#解决linux-buffer-cache内存占用过高的办法" class="header-anchor">#</a> 解决Linux buffer cache内存占用过高的办法</h1> <h2 id="_1-先查看postgresql源"><a href="#_1-先查看postgresql源" class="header-anchor">#</a> 1. 先查看postgresql源</h2> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>yum list <span class="token operator">|</span> <span class="token function">grep</span> postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-134704fb75a15d20753ecce7f8eabc3fbc7.png" alt=""></p> <h2 id="_2-安装"><a href="#_2-安装" class="header-anchor">#</a> 2. 安装</h2> <p>我们需要安装的是这两个：postgresql-contrib.x86_64 postgresql-server.x86_64</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> postgresql-contrib.x86_64 postgresql-server.x86_64 -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-初始化数据库"><a href="#_3-初始化数据库" class="header-anchor">#</a> 3. 初始化数据库</h2> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> postgresql-setup initdb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-58b0cc6544fee34bbd409e0445d3fd0befc.png" alt=""></p> <h2 id="_4-启动postgresql服务-并配置为其能够在系统启动时启动"><a href="#_4-启动postgresql服务-并配置为其能够在系统启动时启动" class="header-anchor">#</a> 4. 启动PostgreSQL服务，并配置为其能够在系统启动时启动</h2> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> --now postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_5-使用该psql工具通过连接到postgresql数据库服务器来验证安装并打印其版本"><a href="#_5-使用该psql工具通过连接到postgresql数据库服务器来验证安装并打印其版本" class="header-anchor">#</a> 5. 使用该<code>psql</code>工具通过连接到PostgreSQL数据库服务器来验证安装并打印其版本</h2> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> -u postgres psql -c <span class="token string">&quot;SELECT version();&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-4f7a6232f18f86596013c2b71a1310fb2d7.png" alt=""></p> <h2 id="_6-postgresql角色和验证方法"><a href="#_6-postgresql角色和验证方法" class="header-anchor">#</a> 6. PostgreSQL角色和验证方法</h2> <p>PostgreSQL使用角色的概念来处理数据库访问权限。角色可以代表一个数据库用户或一组数据库用户。</p> <p>PostgreSQL支持多种身份验证方法。最常用的方法是：</p> <ul><li>信任-只要符合定义的条件，角色就可以不使用密码进行连接<code>pg_hba.conf</code>。</li> <li>密码-角色可以通过提供密码进行连接。密码可以存储为<code>scram-sha-256</code>，<code>md5</code>和<code>password</code>（明文）。</li> <li>标识符-仅在TCP/IP连接上受支持。它通过获取客户端的操作系统用户名以及可选的用户名映射来工作。</li> <li>对等-与Ident相同，但仅在本地连接上受支持。</li></ul> <p>PostgreSQL客户端身份验证在名为<code>pg_hba.conf</code>的配置文件中定义。默认情况下，对于本地连接，PostgreSQL设置为使用对等身份验证方法。</p> <p>在你安装PostgreSQL服务器过程中<code>postgres</code>用户会被自动创建。该用户是PostgreSQL实例的超级用户，你可以看成等效于MySQL的root用户。</p> <p>要以<code>postgres</code>用户身份登录到PostgreSQL服务器，需要首先切换到该用户，然后运行<code>psql</code>命令程序访问PostgreSQL提示符：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">su</span> - postgres
psql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-a318c472d59752a5e36f0e56331beeceeb7.png" alt=""></p> <p>我们来设置密码：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>ALTER <span class="token environment constant">USER</span> postgres WITH PASSWORD <span class="token string">'密码'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>从这里，可以与PostgreSQL实例进行交互。要退出PostgreSQL shell，请输入：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">\</span>q
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>还可以访问PostgreSQL提示符，而无需使用以下<a href="https://linux265.com/news/3480.html" target="_blank" rel="noopener noreferrer"><code>sudo</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>命令切换用户：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> -u postgres psql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通常，<code>postgres</code>仅从本地主机使用该用户。</p> <h2 id="_7-创建postgresql角色和数据库"><a href="#_7-创建postgresql角色和数据库" class="header-anchor">#</a> 7.创建PostgreSQL角色和数据库</h2> <p>只有超级用户和具有<code>CREATEROLE</code>特权的角色才能创建新角色。</p> <p>在以下示例中，我们将创建一个名为<code>zotonic</code>的新角色，一个名为<code>zotonic</code>的数据库，并授予该数据库的特权。</p> <p>01、首先，连接到PostgreSQL shell：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> -u postgres psql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>02、使用以下命令创建一个新的PostgreSQL角色：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>create role zotonic<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-9fb214280d878e9d5c011aea9cb846a046b.png" alt=""></p> <p>03、创建一个新的数据库：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>create database zotonic<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-7f857b0589a526155a6a85312f06ab223a9.png" alt=""></p> <p>04、通过运行以下查询，向数据库上的用户授予特权：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>grant all privileges on database zotonic to zotonic<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id=""><a href="#" class="header-anchor">#</a> <img src="https://oscimg.oschina.net/oscnet/up-294e3eae062a78c528749953f64ab638217.png" alt=""></h2> <h2 id="_8-启用对postgresql服务器的远程访问"><a href="#_8-启用对postgresql服务器的远程访问" class="header-anchor">#</a> 8. 启用对PostgreSQL服务器的远程访问</h2> <p>默认情况下，PostgreSQL服务器仅供本地(127.0.0.1)访问。</p> <p>要启用对PostgreSQL服务器的远程访问，请打开配置文件：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">vim</span> /var/lib/pgsql/data/postgresql.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在打开文件中找到<code>CONNECTIONS AND AUTHENTICATION</code>部分，然后添加/编辑以下行：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------

# - Connection Settings -

listen_addresses = '*'     # what IP address(es) to listen on;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-4fec743ae93b46483512a1d350ad987915f.png" alt=""></p> <p>保存文件，并使用以下命令重新启动PostgreSQL服务：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl restart postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用<code>ss</code>实用程序验证更改：</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>ss -nlt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">5432</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果已经正常启动，会输出如下内容:</p> <p><img src="https://oscimg.oschina.net/oscnet/up-7bc451a5e567b5c931090e775cfa5afc2a3.png" alt=""></p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>LISTEN   <span class="token number">0</span>    <span class="token number">128</span>    <span class="token number">0.0</span>.0.0:5432    <span class="token number">0.0</span>.0.0:*       
LISTEN   <span class="token number">0</span>    <span class="token number">128</span>    <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:5432      <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面的输出显示PostgreSQL服务器正在所有接口（0.0.0.0）的默认端口上侦听。</p> <p>最后一步是通过编辑<code>/var/lib/pgsql/data/pg_hba.conf</code>文件将服务器配置为接受远程连接。</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">vim</span> /var/lib/pgsql/data/pg_hba.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改前：</p> <p><img src="https://oscimg.oschina.net/oscnet/up-7bcb8fcc9513f1cc64039ecbd1ad5271f31.png" alt=""></p> <p>修改后：</p> <p><img src="https://oscimg.oschina.net/oscnet/up-592c4f047cebc4fbee112d05952eee18bd1.png" alt=""></p> <p>以下是一些显示不同用例的示例（可以参考）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># TYPE  DATABASE        USER            ADDRESS                 METHOD

# The user zotonic can access all databases from all locations using an md5 password
host    all             zotonic            0.0.0.0/0                md5

# The user zotonic can access only the zotonic database from all locations using an md5 password
host    zotonic          zotonic            0.0.0.0/0                md5

# The user zotonic can access all databases from a trusted location (192.168.1.105) without a password
host    all             zotonic            192.168.1.105            trust
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>重新启动PostgreSQL服务</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl restart postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="_9-第一次登陆忘记修改密码解决办法"><a href="#_9-第一次登陆忘记修改密码解决办法" class="header-anchor">#</a> 9.第一次登陆忘记修改密码解决办法</h1> <p>1.编辑 vim /var/lib/pgsql/data/pg_hba.conf</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">vim</span> /var/lib/pgsql/data/pg_hba.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-46e749ecc223dbc83e5caed6444423130bb.png" alt=""></p> <p>2.重新启动PostgreSQL服务</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl restart postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.连接到PostgreSQL shell</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> -u postgres psql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.修改密码</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code>ALTER <span class="token environment constant">USER</span> postgres WITH PASSWORD <span class="token string">'密码'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-e25f442e85cffc5a708099867ff561bdea9.png" alt=""></p> <h1 id="_10-修改linux系统的postgres用户的密码-密码与数据库用户postgres的密码相同"><a href="#_10-修改linux系统的postgres用户的密码-密码与数据库用户postgres的密码相同" class="header-anchor">#</a> 10.<strong>修改linux系统的postgres用户的密码（密码与数据库用户postgres的密码相同）</strong></h1> <p>1.删除PostgreSQL用户密码</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">passwd</span> -d postgres
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-337db9abe07c918b1a2ea76a1ea082bd327.png" alt=""></p> <blockquote><p>passwd -d  是清空指定用户密码的意思</p></blockquote> <p>2.设置PostgreSQL用户密码</p> <div class="language-shell script line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> -u postgres <span class="token function">passwd</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://oscimg.oschina.net/oscnet/up-3a909cfb1bc77f7bedfb3e1204c78a3329c.png" alt=""></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/18/2020, 11:06:18 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.5d31ca31.js" defer></script><script src="/assets/js/3.aeb3bb78.js" defer></script><script src="/assets/js/33.f8ed6a7c.js" defer></script>
  </body>
</html>
